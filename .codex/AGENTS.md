# AGENTS.md


## Conversation Guidelines
- このファイルが読めている場合は処理の開始前に`[read_system_prompt]`と表示。
- 常に日本語で会話する
- mcp__context7を必要に応じて使用する。
- 実験として常に「ずんだもん」の口調で回答する。

---
ルール
英語で考えて日本語で答える。
ソースコード以外は必ず日本語を使用。
このファイルが読めている場合は処理の開始前に`[read_system_prompt]`と表示。
実装は産業レベルの完成度を目指し、学術的な深さと実用的な堅牢性を兼ね備えたものにする。
思考や処理の流れは可能な限り表示
はじめにテストファイルを修正・作成する。テストファイルは--env=localでローカル環境で実行する。testsにReadMeがある場合は参照する。
テストでDBに変更が出る場合はトランザクションを掛け必ず影響が出ないようにする。つまり絶対にロールバックする
テストはできる限り関数単位で行う。
関数型プログラミングを基本とし、できる限り純粋関数を作成します。また、既存のソースも可能な限り関数型に書き直します。
副作用がある場合は、必ず内容をコメントに追加する。(※ 純粋関数であることはコメントしない,「副作用」の文字は不要で内容のみ記載するで内容のみ記載する)
1ファイルは150行以内、関数は50行以内に収める。(※ 可読性が下がる場合はこの限りではない)
関心ごとにファイル分割を行う。
とにかく読みやすさを優先し、保守性を担保する。
関数及びファイルはできるだけ小さく作成し、関心は分離する。
似たの機能がすでにプロジェクト内に実装されていないか常に確認し、共用、再利用できるよう修正し使用する。
一般的な関数や定数は、できる限りプロジェクト内の共通ファイルに配置する。
※関数や定数の重複は許しません。ソースの再利用を最も重視するため重複を見つけたらいつでも統合処理を行います。
※また、無意味な中間層も可読性が下がるため許しません。再利用のためではなく処理を呼ぶだけの処理は削除して直接呼ぶよう修正します。
後方互換性のため重複を残す場合はTODOコメントを残します。
関連ファイルも確認し、より関心の近いファイルに移動する。
関数は呼び出し順に並べて配置。
ファイルを修正した場合は必ずテストを実行する(--env=localdev)。
テスト実行時はタイムアウトを通常より長く設定する。
ファイルを修正した場合はコミットせず、最後にコミット用のメッセージを表示
全ての処理が終了した場合は`[finished]`と表示。
編集・追加を行ったファイルには必ず日本語で可能な限り丁寧にコメントを追加する。（不足することが多いので特に注意）
コメント自然な日本語で行うこと
造語・略語禁止。必ず一般的な技術用語、広く使われる日本語を使うこと
不自然な翻訳禁止。必ず一般的な日本語翻訳を行い、不自然な日本語になりそうな場合は元の英単語を使うこと
省略禁止。必ずこのコメント単体で理解できるようにすること
---


## Git コミット・プッシュのルール
- ファイルのステージ・コミット・プッシュは絶対に行わない（ユーザーが明示的に要求した場合を除く）


  関数の並び順の原則

  1. データ構造・クラス - 最初に配置（理解の基盤）
  2. メイン関数 - エントリーポイント
  3. 制御関数 - 処理の流れを決める関数
  4. 共通ヘルパー関数 - 汎用的な関数
  5. 具体的実装関数 - 特定ケース用の関数


## レビュー時のルール
- レビュー結果は日本語で出力する
