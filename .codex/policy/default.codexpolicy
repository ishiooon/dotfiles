prefix_rule(pattern=["/bin/bash", "-lc", "cd /var/projects/net.itsj-draft.ibv3 && python - <<'PY'\nfrom pathlib import Path\ntext = Path('app/Models/Tables/TrnPamphletComment.php').read_text(encoding='utf-8')\nprint(repr(text[-120:]))\nPY"], decision="allow")
prefix_rule(pattern=["/bin/bash", "-lc", "cd /var/projects/net.itsj-draft.ibv3 && python - <<'PY'\nfrom pathlib import Path\npath = Path('app/Models/Tables/TrnPamphletComment.php')\ndata = path.read_bytes()\n# import insertion\nif b'use Illuminate\\\\Support\\\\Collection;' not in data:\n    import_old = b'use App\\\\Models\\\\Tables\\\\TrnPamphletCommentRead;\\r\\n\\r\\n\\r\\nuse App\\\\Casts\\\\DateTimeString;'\n    import_new = b'use App\\\\Models\\\\Tables\\\\TrnPamphletCommentRead;\\r\\nuse Illuminate\\\\Support\\\\Collection;\\r\\n\\r\\nuse App\\\\Casts\\\\DateTimeString;'\n    if import_old in data:\n        data = data.replace(import_old, import_new, 1)\n    else:\n        raise SystemExit('import anchor not found')\n\n# add method\nif b'function fetchListByPamphlet' not in data:\n    marker = b'\\r\\n}\\r\\n'\n    idx = data.rfind(marker)\n    if idx == -1:\n        raise SystemExit('class closing marker not found')\n    insert = (\n        b'    /*-----------------------------------------------------------------------------\\r\\n'\n        b'     * \\xe3\\x83\\x91\\xe3\\x83\\xb3\\xe3\\x83\\x95\\xe3\\x83\\xac\\xe3\\x83\\x83\\xe3\\x83\\x88\\xe3\\x81\\xae\\xe3\\x82\\xb3\\xe3\\x83\\xa1\\xe3\\x83\\xb3\\xe3\\x83\\x88\\xe4\\xb8\\x80\\xe8\\xa6\\xa7\\xe3\\x82\\x92\\xe3\\x83\\x87\\xe3\\x83\\xbc\\xe3\\x82\\xbf\\xe3\\x83\\x99\\xe3\\x83\\xbc\\xe3\\x82\\xb9\\xe3\\x81\\x8b\\xe3\\x82\\x89\\xe5\\x8f\\x96\\xe5\\xbe\\x97\\xe3\\x81\\x99\\xe3\\x82\\x8b\\xe5\\x89\\xaf\\xe4\\xbd\\x9c\\xe7\\x94\\xa8\\xe3\\x80\\x82\\r\\n'\n        b'     *-----------------------------------------------------------------------------*/\\r\\n'\n        b'    public static function fetchListByPamphlet(int $pamphlet_id): Collection\\r\\n'\n        b'    {\\r\\n'\n        b'        return self::PamphletID($pamphlet_id)\\r\\n'\n        b'            ->JoinCommentFiles()\\r\\n'\n        b'            ->NotDelete()\\r\\n'\n        b'            ->orderBy(\\'create_datetime\\', \\'desc\\')\\r\\n'\n        b'            ->get();\\r\\n'\n        b'    }\\r\\n\\r\\n'\n    )\n    data = data[:idx] + insert + data[idx:]\n\npath.write_bytes(data)\nPY"], decision="allow")
